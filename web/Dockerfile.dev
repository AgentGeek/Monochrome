# build stage
FROM node:lts-slim as build-stage
WORKDIR /app
COPY package.json ./
COPY yarn.lock ./
RUN yarn

ARG VUE_APP_DOMAIN_NAME=localhost
ARG VUE_APP_PROTOCOL=http
ARG VUE_APP_TITLE=Monochrome
ARG VUE_APP_MEDIA_PATH=$(VUE_APP_PROTOCOL)://$(VUE_APP_DOMAIN_NAME)/media
ARG VUE_APP_API_PATH=$(VUE_APP_PROTOCOL)://$(VUE_APP_DOMAIN_NAME)/api
ARG VUE_APP_DESCRIPTION
ARG VUE_APP_SECRET
ENV VUE_APP_DOMAIN_NAME=$VUE_APP_DOMAIN_NAME
ENV VUE_APP_PROTOCOL=$VUE_APP_PROTOCOL
ENV VUE_APP_TITLE=$VUE_APP_TITLE
ENV VUE_APP_MEDIA_PATH=$VUE_APP_MEDIA_PATH
ENV VUE_APP_API_PATH=$VUE_APP_API_PATH
ENV VUE_APP_DESCRIPTION=$VUE_APP_DESCRIPTION
ENV VUE_APP_SECRET=$VUE_APP_SECRET


# production stage
FROM build-stage
COPY . .
CMD ["yarn", "serve"]
